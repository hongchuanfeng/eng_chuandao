<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Add Text to Image - Chandao Tools</title>
	<meta name="keywords" content="online tool collection, Chandao Tools">
	<meta name="description" content="Chandao Tools is a collection of free, no-login online utilities across life, dev, encoding/decoding, encryption, images, and fun.">
	<link rel="canonical" href="https://www.chdaoai.com/image/textInImg.html">																			
	<link rel="icon" href="../favicon.ico" type="image/x-icon"/>
	<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		.nav {
			max-width: 1200px;
			margin: 0 auto;
			display: flex;
			gap: 20px;
		}
		.nav-item {
			color: #666;
			text-decoration: none;
			font-size: 14px;
			display: flex;
			align-items: center;
			gap: 5px;
		}
		.container {
			max-width: 1200px;
			margin: 0 auto;
			background: white;
			border-radius: 8px;
			padding: 20px;
			box-shadow: 0 2px 4px rgba(0,0,0,0.1);
		}
		.image-container {
			display: flex;
			gap: 20px;
			margin-bottom: 20px;
		}
		.image-box {
			flex: 1;
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 10px;
		}
		.image-preview {
			width: 100%;
			height: 300px;
			border: 2px dashed #ddd;
			border-radius: 8px;
			display: flex;
			align-items: center;
			justify-content: center;
			overflow: hidden;
			background-color: #f8f9fa;
		}
		.image-preview img {
			max-width: 100%;
			max-height: 100%;
			object-fit: contain;
		}
		.button {
			width: 100%;
			padding: 12px;
			border: none;
			border-radius: 4px;
			font-size: 16px;
			cursor: pointer;
			transition: background-color 0.3s;
		}
		.upload-btn {
			background-color: #ff6b6b;
			color: white;
		}
		.upload-btn:hover {
			background-color: #ff5252;
		}
		.download-btn {
			background-color: #f8f9fa;
			color: #333;
			border: 1px solid #ddd;
		}
		.download-btn:hover {
			background-color: #e9ecef;
		}
		.info-box {
			margin-top: 20px;
			padding: 15px;
			background: #fff5f0;
			border-radius: 4px;
		}
		.info-title {
			color: #ff6b6b;
			margin-bottom: 10px;
		}
		.info-list {
			list-style: none;
			color: #666;
			font-size: 14px;
			line-height: 1.8;
		}
		.info-list li {
			margin-bottom: 5px;
		}
	</style>
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
	<script>
		tailwind.config = {
			theme: {
				extend: {
					colors: {
						primary: '#165DFF',
						secondary: '#FF7D00',
						neutral: '#F5F7FA',
					},
					fontFamily: {
						inter: ['Inter', 'system-ui', 'sans-serif'],
					},
				}
			}
		}
	</script>
	<style type="text/tailwindcss">
		@layer utilities {
			.content-auto {
				content-visibility: auto;
			}
			.shadow-soft {
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
			}
			.transition-custom {
				transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			}
			.text-shadow {
				text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}
		}
	</style>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: system-ui, -apple-system, sans-serif;
		}

		body {
			background-color: #f5f5f5;
		}

		/* ÂìçÂ∫îÂºèÂØºËà™Ê†è */
		nav {
			background: white;
			padding: 1rem 2rem;
			box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			position: relative;
		}

		.nav-container {
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.nav-categories {
			display: flex;
			gap: 2rem;
			z-index: 999;
		}

		.nav-category {
			color: #666;
			cursor: pointer;
			transition: color 0.3s;
			white-space: nowrap;
			text-decoration: none;
		}

		.nav-category:hover {
			color: #007bff;
		}

		.menu-btn {
			display: none;
			background: none;
			border: none;
			font-size: 1.2rem;
			cursor: pointer;
		}

		.container {
			max-width: 1200px;
			margin: 2rem auto;
			padding: 0 1rem;
		}

		/* Â∑•ÂÖ∑Âç°ÁâáÂ∏ÉÂ±Ä */
		.tools-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
			gap: 1.5rem;
			padding: 1rem;
		}

		.tool-card {
			background: white;
			border-radius: 8px;
			padding: 1rem;
			box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			transition: transform 0.3s;
		}

		.tool-card:hover {
			transform: translateY(-3px);
		}

		.tool-icon {
			font-size: 1.5rem;
			color: #007bff;
			margin-bottom: 1rem;
		}

		.category-title {
			color: #444;
			margin: 2rem 0 1rem;
			padding-left: 1rem;
		}

		/* ÁßªÂä®Á´ØÊ†∑Âºè */
		@media (max-width: 768px) {
			.nav-categories {
				display: none;
				position: absolute;
				top: 100%;
				left: 0;
				right: 0;
				background: white;
				flex-direction: column;
				padding: 1rem;
				box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			}

			.nav-categories.active {
				display: flex;
			}

			.nav-category {
				padding: 0.5rem 0;
				text-decoration: none;
			}

			.menu-btn {
				display: block;
			}

			nav {
				padding: 1rem;
			}
		}
	</style>
	<!-- Google tag (gtag.js2) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-8NMLH22Y6G"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-8NMLH22Y6G');
	</script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7274710287377352"
			crossorigin="anonymous"></script>


</head>
<body>
<nav>
	<div class="nav-container">
		<div class="logo">
			<a href="../index.html" class="nav-item">
				<img src="../static/images/logo.png" width="100px" style="margin-right: 60px"/>
			</a>
		</div>
		<button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
		<div class="nav-categories">
			<a href="../index.html" class="nav-category">üîç Recommended</a>
			<a href="../life.html" class="nav-category">üè† Life Tools</a>
			<a href="../encry.html" class="nav-category">üîí Encryption</a>
			<a href="../code.html" class="nav-category">üìù Encoding</a>
			<a href="../dev.html" class="nav-category">üíª Dev Tools</a>
			<a href="../image.html" class="nav-category">üñºÔ∏è Image Tools</a>
			<a href="../game.html" class="nav-category">üéÆ Fun Tools</a>
		</div>
	</div>
</nav>

<div class="container">

	<!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫ -->
	<main class="flex-grow container mx-auto px-4 py-8">
		<div class="max-w-6xl mx-auto">
			<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
				<!-- Â∑¶‰æßÊéßÂà∂Èù¢Êùø -->
				<div class="lg:col-span-1">
					<div class="bg-white rounded-xl shadow-soft p-6 sticky top-24">
						<h2 class="text-xl font-bold text-gray-800 mb-6">Editing Options</h2>

						<!-- ‰∏ä‰º†ÂõæÁâá -->
						<div class="mb-6">
							<label class="block text-sm font-medium text-gray-700 mb-2">Select Image</label>
							<div id="drop-area" class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center transition-custom hover:border-primary cursor-pointer bg-neutral">
								<i class="fa fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
								<p class="text-sm text-gray-500">Drag and drop here or</p>
								<label class="inline-block mt-2 bg-primary hover:bg-primary/90 text-white text-sm font-medium py-1.5 px-4 rounded-md cursor-pointer transition-custom">
									<i class="fa fa-folder-open mr-1"></i>Select Image
									<input type="file" id="file-input" class="hidden" accept="image/*">
								</label>
							</div>
							<div id="image-preview" class="mt-4 hidden">
								<img id="preview-img" src="" alt="Preview" class="w-full h-auto rounded-lg shadow-sm">
								<button id="remove-img" class="mt-2 text-sm text-red-500 hover:text-red-600 transition-custom">
									<i class="fa fa-trash mr-1"></i>Remove Image
								</button>
							</div>
						</div>

						<!-- Ê∑ªÂä†ÊñáÂ≠ó -->
						<div class="mb-6">
							<label class="block text-sm font-medium text-gray-700 mb-2">Add Text</label>
							<textarea id="text-input" rows="2" placeholder="Enter text to add..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"></textarea>
							<button id="add-text-btn" class="mt-3 w-full bg-secondary hover:bg-secondary/90 text-white font-medium py-2 px-4 rounded-md transition-custom flex items-center justify-center">
								<i class="fa fa-font mr-2"></i>Add Text
							</button>
						</div>

						<!-- ÊñáÂ≠óÊ†∑Âºè -->
						<div class="mb-6">
							<h3 class="text-sm font-medium text-gray-700 mb-3 flex items-center">
								<i class="fa fa-paint-brush mr-2"></i>Text Style
							</h3>

							<!-- Â≠ó‰ΩìÂ§ßÂ∞è -->
							<div class="mb-4">
								<label for="font-size" class="block text-xs text-gray-500 mb-1">Font Size</label>
								<div class="flex items-center space-x-3">
									<input type="range" id="font-size" min="12" max="100" value="36" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
									<span id="font-size-value" class="text-sm font-medium text-gray-700 min-w-[2.5rem] text-right">36px</span>
								</div>
							</div>

							<!-- Â≠ó‰ΩìÈ¢úËâ≤ -->
							<div class="mb-4">
								<label for="text-color" class="block text-xs text-gray-500 mb-1">Text Color</label>
								<div class="flex items-center space-x-4">
									<input type="color" id="text-color" value="#ffffff" class="w-8 h-8 rounded-full border-0 cursor-pointer">
									<input type="text" id="text-color-text" value="#ffffff" class="w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary text-sm">
								</div>
							</div>

							<!-- ÂØπÈΩêÊñπÂºè -->
							<div class="mb-4">
								<label class="block text-xs text-gray-500 mb-1">Alignment</label>
								<div class="flex space-x-2">
									<button class="text-align-btn flex-1 py-1.5 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom" data-align="left">
										<i class="fa fa-align-left"></i>
									</button>
									<button class="text-align-btn flex-1 py-1.5 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom" data-align="center">
										<i class="fa fa-align-center"></i>
									</button>
									<button class="text-align-btn flex-1 py-1.5 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom" data-align="right">
										<i class="fa fa-align-right"></i>
									</button>
								</div>
							</div>

							<!-- Â≠ó‰ΩìÊ†∑Âºè -->
							<div class="flex flex-wrap gap-2 mb-4">
								<button id="bold-btn" class="py-1 px-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom text-sm">
									<b>B</b>
								</button>
								<button id="italic-btn" class="py-1 px-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom text-sm">
									<i>I</i>
								</button>
								<button id="underline-btn" class="py-1 px-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom text-sm">
									<u>U</u>
								</button>
								<button id="stroke-btn" class="py-1 px-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom text-sm">
									<span style="text-decoration: line-through;">S</span>
								</button>
							</div>

							<!-- ÊñáÂ≠óÈò¥ÂΩ± -->
							<div>
								<label class="flex items-center justify-between text-xs text-gray-500 mb-1">
									<span>Text Shadow</span>
									<span id="shadow-value" class="text-gray-700">Off</span>
								</label>
								<div class="flex items-center space-x-2">
									<input type="range" id="text-shadow" min="0" max="10" value="0" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
									<button id="shadow-toggle" class="text-gray-400 hover:text-gray-600 transition-custom">
										<i class="fa fa-toggle-off"></i>
									</button>
								</div>
							</div>
						</div>

						<!-- ‰ΩçÁΩÆË∞ÉÊï¥ -->
						<div class="mb-6">
							<h3 class="text-sm font-medium text-gray-700 mb-3 flex items-center">
								<i class="fa fa-arrows-alt mr-2"></i>Position
							</h3>

							<!-- X ‰ΩçÁΩÆ -->
							<div class="mb-4">
								<label for="pos-x" class="block text-xs text-gray-500 mb-1">Horizontal</label>
								<div class="flex items-center space-x-3">
									<input type="range" id="pos-x" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
									<span id="pos-x-value" class="text-sm font-medium text-gray-700 min-w-[2.5rem] text-right">50%</span>
								</div>
							</div>

							<!-- Y ‰ΩçÁΩÆ -->
							<div>
								<label for="pos-y" class="block text-xs text-gray-500 mb-1">Vertical</label>
								<div class="flex items-center space-x-3">
									<input type="range" id="pos-y" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
									<span id="pos-y-value" class="text-sm font-medium text-gray-700 min-w-[2.5rem] text-right">50%</span>
								</div>
							</div>
						</div>

						<!-- Êìç‰ΩúÊåâÈíÆ -->
						<div class="flex space-x-3">
							<button id="reset-btn" class="flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 font-medium hover:bg-gray-50 transition-custom">
								<i class="fa fa-refresh mr-1"></i>Reset
							</button>
							<button id="save-btn" class="flex-1 px-4 py-2 bg-primary hover:bg-primary/90 text-white font-medium rounded-md transition-custom">
								<i class="fa fa-download mr-1"></i>Save Image
							</button>
						</div>
					</div>
				</div>

				<!-- Âè≥‰æßÈ¢ÑËßàÂå∫ -->
				<div class="lg:col-span-2">
					<div class="bg-white rounded-xl shadow-soft p-6 h-full">
						<h2 class="text-xl font-bold text-gray-800 mb-6">Preview</h2>

						<div id="canvas-container" class="relative bg-neutral rounded-lg overflow-hidden" style="height: 600px;">
							<!-- ÁîªÂ∏ÉÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
							<canvas id="image-canvas" class="w-full h-full"></canvas>

							<!-- Êó†ÂõæÁâáÊèêÁ§∫ -->
							<div id="no-image-placeholder" class="absolute inset-0 flex flex-col items-center justify-center text-gray-400">
								<i class="fa fa-image text-6xl mb-4"></i>
								<p class="text-lg">Please upload an image to edit</p>
							</div>
						</div>

						<!-- ÊèêÁ§∫‰ø°ÊÅØ -->
						<div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-700">
							<h4 class="font-medium mb-2 flex items-center">
								<i class="fa fa-lightbulb-o mr-2"></i>Tips
							</h4>
							<ul class="list-disc pl-5 space-y-1">
								<li>After adding text, you can adjust its position and style</li>
								<li>You can add multiple texts, each of which is independently editable</li>
								<li>Click on the added text to select it for editing</li>
								<li>Use the sliders to precisely control the text position and size</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

</div>

<script>
	// DOM ÂÖÉÁ¥†
	const dropArea = document.getElementById('drop-area');
	const fileInput = document.getElementById('file-input');
	const imagePreview = document.getElementById('image-preview');
	const previewImg = document.getElementById('preview-img');
	const removeImg = document.getElementById('remove-img');
	const textInput = document.getElementById('text-input');
	const addTextBtn = document.getElementById('add-text-btn');
	const fontSize = document.getElementById('font-size');
	const fontSizeValue = document.getElementById('font-size-value');
	const textColor = document.getElementById('text-color');
	const textColorText = document.getElementById('text-color-text');
	const textAlignBtns = document.querySelectorAll('.text-align-btn');
	const boldBtn = document.getElementById('bold-btn');
	const italicBtn = document.getElementById('italic-btn');
	const underlineBtn = document.getElementById('underline-btn');
	const strokeBtn = document.getElementById('stroke-btn');
	const textShadow = document.getElementById('text-shadow');
	const shadowValue = document.getElementById('shadow-value');
	const shadowToggle = document.getElementById('shadow-toggle');
	const posX = document.getElementById('pos-x');
	const posXValue = document.getElementById('pos-x-value');
	const posY = document.getElementById('pos-y');
	const posYValue = document.getElementById('pos-y-value');
	const resetBtn = document.getElementById('reset-btn');
	const saveBtn = document.getElementById('save-btn');
	const canvas = document.getElementById('image-canvas');
	const ctx = canvas.getContext('2d');
	const noImagePlaceholder = document.getElementById('no-image-placeholder');

	// Â≠òÂÇ®ÂΩìÂâçÁºñËæëÁöÑÊñáÊú¨ÂØπË±°Á¥¢Âºï
	let currentTextIndex = -1;

	// Â≠òÂÇ®ÊâÄÊúâÊ∑ªÂä†ÁöÑÊñáÊú¨ÂØπË±°
	let texts = [];

	// ÂõæÁâáÂØπË±°
	let image = null;

	// ÊñáÊú¨Ê†∑ÂºèÈªòËÆ§ÂÄº
	let textStyle = {
		fontSize: 36,
		color: '#ffffff',
		align: 'center',
		bold: false,
		italic: false,
		underline: false,
		stroke: false,
		shadow: 0,
		posX: 50,
		posY: 50
	};

	// ÂàùÂßãÂåñÁîªÂ∏ÉÂ∞∫ÂØ∏
	function initCanvasSize() {
		const container = document.getElementById('canvas-container');
		canvas.width = container.clientWidth;
		canvas.height = container.clientHeight;
		redrawCanvas();
	}

	// ÁõëÂê¨Á™óÂè£Â§ßÂ∞èÂèòÂåñÔºåË∞ÉÊï¥ÁîªÂ∏ÉÂ∞∫ÂØ∏
	window.addEventListener('resize', initCanvasSize);

	// ÂàùÂßãÂåñ
	initCanvasSize();

	// ÊãñÊîæ‰∫ã‰ª∂Â§ÑÁêÜ
	['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
		dropArea.addEventListener(eventName, preventDefaults, false);
	});

	function preventDefaults(e) {
		e.preventDefault();
		e.stopPropagation();
	}

	['dragenter', 'dragover'].forEach(eventName => {
		dropArea.addEventListener(eventName, highlight, false);
	});

	['dragleave', 'drop'].forEach(eventName => {
		dropArea.addEventListener(eventName, unhighlight, false);
	});

	function highlight() {
		dropArea.classList.add('border-primary', 'bg-primary/5');
	}

	function unhighlight() {
		dropArea.classList.remove('border-primary', 'bg-primary/5');
	}

	dropArea.addEventListener('drop', handleDrop, false);

	function handleDrop(e) {
		const dt = e.dataTransfer;
		const file = dt.files[0];
		if (file) {
			handleFile(file);
		}
	}

	// Êñá‰ª∂ÈÄâÊã©
	fileInput.addEventListener('change', () => {
		const file = fileInput.files[0];
		if (file) {
			handleFile(file);
		}
	});

	// ÁßªÈô§ÂõæÁâá
	removeImg.addEventListener('click', () => {
		image = null;
		imagePreview.classList.add('hidden');
		noImagePlaceholder.classList.remove('hidden');
		redrawCanvas();
	});

	// Â§ÑÁêÜ‰∏ä‰º†ÁöÑÊñá‰ª∂
	function handleFile(file) {
		if (!file.type.match('image.*')) {
			alert('Please upload an image file');
			return;
		}

		const reader = new FileReader();

		reader.onload = function(e) {
			image = new Image();
			image.onload = function() {
				// Show preview
				previewImg.src = e.target.result;
				imagePreview.classList.remove('hidden');
				noImagePlaceholder.classList.add('hidden');

				// ÈáçÁªòÁîªÂ∏É
				redrawCanvas();
			};
			image.src = e.target.result;
		};

		reader.readAsDataURL(file);
	}

	// Ê∑ªÂä†ÊñáÂ≠ó
	addTextBtn.addEventListener('click', () => {
		const text = textInput.value.trim();
		if (!text) {
			alert('Please enter text content!');
			return;
		}

		// Ê∑ªÂä†Êñ∞ÊñáÊú¨ÂØπË±°
		texts.push({
			text,
			...textStyle
		});

		// Êõ¥Êñ∞ÂΩìÂâçÊñáÊú¨Á¥¢Âºï
		currentTextIndex = texts.length - 1;

		// Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü
		textInput.value = '';

		// ÈáçÁªòÁîªÂ∏É
		redrawCanvas();
	});

	// ÁîªÂ∏ÉÁÇπÂáª‰∫ã‰ª∂ - ÈÄâÊã©ÊñáÊú¨
	canvas.addEventListener('click', (e) => {
		if (!image) return;

		const rect = canvas.getBoundingClientRect();
		const clickX = e.clientX - rect.left;
		const clickY = e.clientY - rect.top;

		// ‰ªéÂêéÂæÄÂâçÊ£ÄÊü•Ôºå‰ºòÂÖàÈÄâÊã©ÊúÄ‰∏äÈù¢ÁöÑÊñáÊú¨
		for (let i = texts.length - 1; i >= 0; i--) {
			const text = texts[i];
			ctx.save();
			ctx.font = getFontString(text);
			const textWidth = ctx.measureText(text.text).width;
			const textHeight = text.fontSize;

			// ËÆ°ÁÆóÊñáÊú¨ÂåÖÂõ¥Áõí
			let x, y;
			if (text.align === 'left') {
				x = (text.posX / 100) * canvas.width;
			} else if (text.align === 'center') {
				x = (text.posX / 100) * canvas.width - textWidth / 2;
			} else { // right
				x = (text.posX / 100) * canvas.width - textWidth;
			}
			y = (text.posY / 100) * canvas.height;

			// Ê£ÄÊü•ÁÇπÂáªÊòØÂê¶Âú®ÊñáÊú¨ËåÉÂõ¥ÂÜÖ
			if (clickX >= x && clickX <= x + textWidth &&
					clickY >= y - textHeight && clickY <= y) {
				currentTextIndex = i;
				updateControls();
				redrawCanvas();
				ctx.restore();
				return;
			}
			ctx.restore();
		}

		// Â¶ÇÊûúÊ≤°ÊúâÁÇπÂáªÂà∞‰ªª‰ΩïÊñáÊú¨ÔºåÂèñÊ∂àÈÄâÊã©
		currentTextIndex = -1;
		redrawCanvas();
	});

	// Êõ¥Êñ∞ÊéßÂà∂ÈÄâÈ°π
	function updateControls() {
		if (currentTextIndex === -1) {
			// Ê≤°ÊúâÈÄâ‰∏≠ÁöÑÊñáÊú¨ÔºåÈáçÁΩÆ‰∏∫ÈªòËÆ§Ê†∑Âºè
			textStyle = {
				fontSize: 36,
				color: '#ffffff',
				align: 'center',
				bold: false,
				italic: false,
				underline: false,
				stroke: false,
				shadow: 0,
				posX: 50,
				posY: 50
			};
		} else {
			// ‰ΩøÁî®ÈÄâ‰∏≠ÁöÑÊñáÊú¨Ê†∑Âºè
			textStyle = { ...texts[currentTextIndex] };
		}

		// Êõ¥Êñ∞UI
		fontSize.value = textStyle.fontSize;
		fontSizeValue.textContent = `${textStyle.fontSize}px`;

		textColor.value = textStyle.color;
		textColorText.value = textStyle.color;

		textAlignBtns.forEach(btn => {
			if (btn.dataset.align === textStyle.align) {
				btn.classList.add('bg-primary/10', 'border-primary');
			} else {
				btn.classList.remove('bg-primary/10', 'border-primary');
			}
		});

		boldBtn.classList.toggle('bg-primary/10', textStyle.bold);
		italicBtn.classList.toggle('bg-primary/10', textStyle.italic);
		underlineBtn.classList.toggle('bg-primary/10', textStyle.underline);
		strokeBtn.classList.toggle('bg-primary/10', textStyle.stroke);

		textShadow.value = textStyle.shadow;
		shadowValue.textContent = textStyle.shadow > 0 ? 'On' : 'Off';
		shadowToggle.innerHTML = textStyle.shadow > 0 ?
				'<i class="fa fa-toggle-on text-primary"></i>' :
				'<i class="fa fa-toggle-off text-gray-400"></i>';

		posX.value = textStyle.posX;
		posXValue.textContent = `${textStyle.posX}%`;

		posY.value = textStyle.posY;
		posYValue.textContent = `${textStyle.posY}%`;
	}

	// ÁõëÂê¨Â≠ó‰ΩìÂ§ßÂ∞èÂèòÂåñ
	fontSize.addEventListener('input', () => {
		textStyle.fontSize = parseInt(fontSize.value);
		fontSizeValue.textContent = `${textStyle.fontSize}px`;
		updateCurrentText();
	});

	// ÁõëÂê¨ÊñáÊú¨È¢úËâ≤ÂèòÂåñ
	textColor.addEventListener('input', () => {
		textStyle.color = textColor.value;
		textColorText.value = textColor.value;
		updateCurrentText();
	});

	textColorText.addEventListener('input', () => {
		if (/^#([0-9A-F]{3}){1,2}$/i.test(textColorText.value)) {
			textStyle.color = textColorText.value;
			textColor.value = textColorText.value;
			updateCurrentText();
		}
	});

	// ÁõëÂê¨ÂØπÈΩêÊñπÂºèÂèòÂåñ
	textAlignBtns.forEach(btn => {
		btn.addEventListener('click', () => {
			// ÁßªÈô§ÊâÄÊúâÊåâÈíÆÁöÑÈÄâ‰∏≠Áä∂ÊÄÅ
			textAlignBtns.forEach(b => {
				b.classList.remove('bg-primary/10', 'border-primary');
			});

			// Ê∑ªÂä†ÂΩìÂâçÊåâÈíÆÁöÑÈÄâ‰∏≠Áä∂ÊÄÅ
			btn.classList.add('bg-primary/10', 'border-primary');

			// Êõ¥Êñ∞Ê†∑Âºè
			textStyle.align = btn.dataset.align;
			updateCurrentText();
		});
	});

	// ÁõëÂê¨Â≠ó‰ΩìÊ†∑ÂºèÂèòÂåñ
	boldBtn.addEventListener('click', () => {
		textStyle.bold = !textStyle.bold;
		boldBtn.classList.toggle('bg-primary/10', textStyle.bold);
		updateCurrentText();
	});

	italicBtn.addEventListener('click', () => {
		textStyle.italic = !textStyle.italic;
		italicBtn.classList.toggle('bg-primary/10', textStyle.italic);
		updateCurrentText();
	});

	underlineBtn.addEventListener('click', () => {
		textStyle.underline = !textStyle.underline;
		underlineBtn.classList.toggle('bg-primary/10', textStyle.underline);
		updateCurrentText();
	});

	strokeBtn.addEventListener('click', () => {
		textStyle.stroke = !textStyle.stroke;
		strokeBtn.classList.toggle('bg-primary/10', textStyle.stroke);
		updateCurrentText();
	});

	// ÁõëÂê¨ÊñáÂ≠óÈò¥ÂΩ±ÂèòÂåñ
	textShadow.addEventListener('input', () => {
		textStyle.shadow = parseInt(textShadow.value);
		shadowValue.textContent = textStyle.shadow > 0 ? 'On' : 'Off';
		shadowToggle.innerHTML = textStyle.shadow > 0 ?
				'<i class="fa fa-toggle-on text-primary"></i>' :
				'<i class="fa fa-toggle-off text-gray-400"></i>';
		updateCurrentText();
	});

	shadowToggle.addEventListener('click', () => {
		textStyle.shadow = textStyle.shadow > 0 ? 0 : 3;
		textShadow.value = textStyle.shadow;
		shadowValue.textContent = textStyle.shadow > 0 ? 'On' : 'Off';
		shadowToggle.innerHTML = textStyle.shadow > 0 ?
				'<i class="fa fa-toggle-on text-primary"></i>' :
				'<i class="fa fa-toggle-off text-gray-400"></i>';
		updateCurrentText();
	});

	// ÁõëÂê¨‰ΩçÁΩÆÂèòÂåñ
	posX.addEventListener('input', () => {
		textStyle.posX = parseInt(posX.value);
		posXValue.textContent = `${textStyle.posX}%`;
		updateCurrentText();
	});

	posY.addEventListener('input', () => {
		textStyle.posY = parseInt(posY.value);
		posYValue.textContent = `${textStyle.posY}%`;
		updateCurrentText();
	});

	// ÈáçÁΩÆÊåâÈíÆ
	resetBtn.addEventListener('click', () => {
		if (currentTextIndex !== -1) {
			// If a text is selected, reset only that text
			texts.splice(currentTextIndex, 1);
			currentTextIndex = -1;
			updateControls();
			redrawCanvas();
		} else {
			// Otherwise reset all
			texts = [];
			currentTextIndex = -1;
			updateControls();
			redrawCanvas();
		}
	});

	// ‰øùÂ≠òÊåâÈíÆ
	saveBtn.addEventListener('click', () => {
		if (!image && texts.length === 0) {
			alert('Please upload an image and add text first');
			return;
		}

		// Create a temporary canvas to ensure quality
		const tempCanvas = document.createElement('canvas');
		const tempCtx = tempCanvas.getContext('2d');

		// Set temp canvas size to original image
		if (image) {
			tempCanvas.width = image.width;
			tempCanvas.height = image.height;

			// Draw image
			tempCtx.drawImage(image, 0, 0);
		} else {
			// If no image, use current canvas size
			tempCanvas.width = canvas.width;
			tempCanvas.height = canvas.height;

			// Set background color
			tempCtx.fillStyle = '#ffffff';
			tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
		}

		// Draw all texts
		texts.forEach(text => {
			drawText(tempCtx, text, tempCanvas.width, tempCanvas.height);
		});

		// Create download link
		const link = document.createElement('a');
		link.download = 'image-with-text.png';
		link.href = tempCanvas.toDataURL('image/png');
		link.click();
	});

	// Êõ¥Êñ∞ÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñáÊú¨
	function updateCurrentText() {
		if (currentTextIndex !== -1) {
			texts[currentTextIndex] = { ...textStyle };
			redrawCanvas();
		}
	}

	// Ëé∑ÂèñÂ≠ó‰ΩìÂ≠óÁ¨¶‰∏≤
	function getFontString(text) {
		let font = '';
		if (text.italic) font += 'italic ';
		if (text.bold) font += 'bold ';
		font += `${text.fontSize}px Inter, sans-serif`;
		return font;
	}

	// ÁªòÂà∂ÊñáÊú¨
	function drawText(ctx, text, canvasWidth, canvasHeight) {
		ctx.save();

		// ËÆæÁΩÆÂ≠ó‰ΩìÂíåÊ†∑Âºè
		ctx.font = getFontString(text);
		ctx.fillStyle = text.color;
		ctx.textAlign = text.align;
		ctx.textBaseline = 'middle';

		// ËÆæÁΩÆÈò¥ÂΩ±
		if (text.shadow > 0) {
			ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
			ctx.shadowBlur = text.shadow;
			ctx.shadowOffsetX = 2;
			ctx.shadowOffsetY = 2;
		}

		// ËÆ°ÁÆóÊñáÊú¨‰ΩçÁΩÆ
		let x, y;
		if (text.align === 'left') {
			x = (text.posX / 100) * canvasWidth;
		} else if (text.align === 'center') {
			x = (text.posX / 100) * canvasWidth;
		} else { // right
			x = (text.posX / 100) * canvasWidth;
		}
		y = (text.posY / 100) * canvasHeight;

		// ÁªòÂà∂ÊñáÊú¨
		ctx.fillText(text.text, x, y);

		// ÁªòÂà∂‰∏ãÂàíÁ∫øÊàñÂà†Èô§Á∫ø
		if (text.underline || text.stroke) {
			const textWidth = ctx.measureText(text.text).width;
			const lineY = text.stroke ? y - text.fontSize / 8 : y + text.fontSize / 3;

			ctx.beginPath();
			ctx.moveTo(x - textWidth / 2, lineY);
			ctx.lineTo(x + textWidth / 2, lineY);
			ctx.lineWidth = 2;
			ctx.strokeStyle = text.color;
			ctx.stroke();
		}

		// Â¶ÇÊûúÊòØÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñáÊú¨ÔºåÁªòÂà∂ÈÄâ‰∏≠Ê°Ü
		if (currentTextIndex !== -1 && texts[currentTextIndex] === text) {
			const textWidth = ctx.measureText(text.text).width;
			const padding = 10;

			ctx.strokeStyle = '#165DFF';
			ctx.lineWidth = 2;
			ctx.setLineDash([5, 3]);

			ctx.strokeRect(
					x - textWidth / 2 - padding,
					y - text.fontSize / 2 - padding,
					textWidth + padding * 2,
					text.fontSize + padding * 2
			);

			ctx.setLineDash([]);
		}

		ctx.restore();
	}

	// ÈáçÁªòÁîªÂ∏É
	function redrawCanvas() {
		// Ê∏ÖÁ©∫ÁîªÂ∏É
		ctx.clearRect(0, 0, canvas.width, canvas.height);

		// Â¶ÇÊûúÊúâÂõæÁâáÔºåÁªòÂà∂ÂõæÁâá
		if (image) {
			// ËÆ°ÁÆóÂõæÁâáÂú®ÁîªÂ∏É‰∏≠ÁöÑÊúÄ‰Ω≥ÊòæÁ§∫‰ΩçÁΩÆÔºàÂ±Ö‰∏≠‰∏îÁ≠âÊØî‰æãÁº©ÊîæÔºâ
			const imgRatio = image.width / image.height;
			const canvasRatio = canvas.width / canvas.height;

			let displayWidth, displayHeight, x, y;

			if (imgRatio > canvasRatio) {
				// ÂõæÁâáÊØîÁîªÂ∏ÉÂÆΩÔºå‰ª•ÂÆΩÂ∫¶‰∏∫Âü∫ÂáÜ
				displayWidth = canvas.width;
				displayHeight = canvas.width / imgRatio;
				x = 0;
				y = (canvas.height - displayHeight) / 2;
			} else {
				// ÂõæÁâáÊØîÁîªÂ∏ÉÈ´òÔºå‰ª•È´òÂ∫¶‰∏∫Âü∫ÂáÜ
				displayHeight = canvas.height;
				displayWidth = canvas.height * imgRatio;
				x = (canvas.width - displayWidth) / 2;
				y = 0;
			}

			// ÁªòÂà∂ÂõæÁâá
			ctx.drawImage(image, x, y, displayWidth, displayHeight);

			// ‰øùÂ≠òÂõæÁâáÁöÑÊòæÁ§∫‰ø°ÊÅØÔºåÁî®‰∫éÊñáÊú¨ÂÆö‰Ωç
			image.displayInfo = { x, y, width: displayWidth, height: displayHeight };
		}

		// ÁªòÂà∂ÊâÄÊúâÊñáÊú¨
		texts.forEach(text => {
			drawText(ctx, text, canvas.width, canvas.height);
		});
	}

</script>
</body>

<script>
	function toggleMenu() {
		const nav = document.querySelector('.nav-categories');
		nav.classList.toggle('active');

		// ÁÇπÂáªËèúÂçïÈ°πÂêéËá™Âä®ÂÖ≥Èó≠
		document.querySelectorAll('.nav-category').forEach(item => {
			item.addEventListener('click', () => {
				if (window.innerWidth <= 768) {
					nav.classList.remove('active');
				}
			});
		});
	}
</script>



</html>